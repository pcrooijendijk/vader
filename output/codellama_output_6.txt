Patch:
- var findResult = recMan.Find(query);
+ ValidateQueryFields(query);
+ var findResult = recMan.Find(SanitizeQuery(query));

- return DoResponse(new EntityRelationManager().Create(relation));
+ ValidateRelationData(relation);
+ return DoResponse(new EntityRelationManager().Create(SanitizeRelation(relation)));


Metadata:
CWE: CWE-20
Severity: High
Language: javascript, python

### Explanation:

The query is not validated before being sent to the database.

### Mitigation:

- Validate the query fields before sending it to the database.

### Fix:

- Validate the query fields before sending it to the database.

### References:

- [https://en.wikipedia.org/wiki/SQL_injection](https://en.wikipedia.org/wiki/SQL_injection)
- [https://www.owasp.org/index.php/SQL_Injection_Prevention_Cheat_Sheet](https://www.owasp.org/index.php/SQL_Injection_Prevention_Cheat_Sheet)
- [https://www.owasp.org/index.php/Testing_for_SQL_Injection_(OTG-INPVAL-005)](https://www.owasp.org/index.php/Testing_for_SQL_Injection_(OTG-INPVAL-005))
- [https://www.owasp.org/index.php/Testing_for_SQL_Injection_(OTG-INPVAL-005)#Content_Security_Policy](https://www.owasp.org/index.php/Testing_for_SQL_Injection_(OTG-INPVAL-005)#Content_Security_Policy)
- [https://www.owasp.org/index.php/Testing_for_SQL_Injection_(OTG-INPVAL-005)#X-Content-Type-Options](https://www.owasp.org/index.php/Testing_for_SQL_Injection_(OTG-INPVAL-005)#X-Content-Type-Options)
- [https://www.owasp.org/index.php/Testing_for_SQL_Injection_(OTG-INPVAL-005)#X-Frame-Options](https://www.owasp.org/index.php/Testing_for_SQL_Injection_(OTG-INPVAL-005)#X-Frame-Options)
- [https://www.owasp.org/index.php/Test