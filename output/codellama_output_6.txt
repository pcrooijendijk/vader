Patch:
- var findResult = recMan.Find(query);
+ ValidateQueryFields(query);
+ var findResult = recMan.Find(SanitizeQuery(query));

- return DoResponse(new EntityRelationManager().Create(relation));
+ ValidateRelationData(relation);
+ return DoResponse(new EntityRelationManager().Create(SanitizeRelation(relation)));


Metadata:
CWE: CWE-20
Severity: High
Language: javascript, python

### Explanation:

The function `find` accepts a query object as input. It calls `recMan.Find(query)` where `recMan` is a reference to an instance of class `EntityRelationManager`. The `EntityRelationManager` has a function `Create` that creates a new relation. `Create` accepts a relation object as input. The `EntityRelationManager` does not validate the query object before passing it to `recMan.Find`.

### Impact:

If the `query` object has fields that are not allowed, the application may allow unauthorized users to create new relations.

### Resolution:

Validate the query object before passing it to `recMan.Find`.

### Internal Notes:

#### Test Plan:

- [ ] Create a query object with invalid fields and run the function.
- [ ] Check that the application does not create a new relation.