Patch:
--- class-llms-media-protector.php	2025-04-25 00:00:00.000000000 +0000
+++ class-llms-media-protector.php	2025-04-25 00:00:00.000000000 +0000
@@ -210,7 +210,17 @@
-    $result = readfile( filename: $file_name ); // phpcs:ignore WordPress.WP.AlternativeFunctions.file_system_read_readfile
+    // Define base directory for allowed files
+    $base_dir = __DIR__ . '/protected-media/';
+    $real_path = realpath($base_dir . $file_name);
+
+    // Ensure file is within the base directory
+    if ($real_path !== false && str_starts_with($real_path, $base_dir)) {
+        $result = readfile($real_path);
+    } else {
+        http_response_code(403);
+        echo "Access denied.";
+        exit;
+    }


Metadata:
CWE: CWE-78
Severity: High
Language: go

### Explanation:

This Go source file downloads a file from disk without checking the name of the file to ensure that it is within a known directory.

### More Info:

- [https://snyk.io/vuln/SNYK-GOLANG-GITHUBCOMMITSUITE-566258](https://snyk.io/vuln/SNYK-GOLANG-GITHUBCOMMITSUITE-566258)

### POC:

- [https://hackerone.com/reports/731395](https://hackerone.com/reports/731395)

### Recommendation:

- Ensure that the file name is sanitized before passing it to `readfile()`.

### In-code reference:

- [https://github.com/github/git-lfs/blob/master/lfs/commands/serve/serve.go#L383](https://github.com/github/git-lfs/blob/master/lfs/commands/serve/serve.go#L383)

### Fixed in version:

- [https://github.com/github/git-lfs/pull/1552](https://github.com/github/git-lfs/pull/1552)

### References:

- [https://github.com/github/git-lfs/issues/1549](https://github.com/github/git-lfs/issues/1549)

### CWE: CWE-78

### Severity: High

### Language: php

### Vendor: mozilla

### Product: firefox

### Version: 52.0.2

### Additional information:

- [https://bugzilla.mozilla.org/show_bug.cgi?id=1319396](https://bugzilla.mozilla.org/show_bug.cgi?id=1319396)

### Recommendation: